<div class="budget-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Remaining Budget Dashboard</h1>
      <p class="page-subtitle">Current available budget analysis and departmental insights</p>
    </div>
    <div class="header-actions">
      <div class="last-updated">
        <span class="update-label">Last updated:</span>
        <span class="update-time">{{ getCurrentTime() }}</span>
      </div>
      <button class="refresh-btn" (click)="refreshBudgets()" [disabled]="loading">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 4V10H7M23 20V14H17M20.49 9A9 9 0 0 0 5.64 5.64L1 10M22.99 14A9 9 0 0 1 18.36 18.36L23 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Refresh Data
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading budget data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-state">
    <div class="error-icon">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
      </svg>
    </div>
    <h3>Error Loading Budgets</h3>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadBudgets()">Try Again</button>
  </div>

  <!-- Budget Visualizations -->
  <div *ngIf="!loading && !error" class="budget-dashboard">
    
    <!-- Main Dashboard Grid -->
    <div class="dashboard-grid">
      
      <!-- Large Chart 1: Bar Chart - Main Focus -->
      <div class="chart-card large primary">
        <div class="chart-header">
          <h3>Remaining Budget by Department</h3>
          <p>Current available budget for each department</p>
        </div>
        <div class="chart-wrapper large">
          <canvas baseChart
                  [data]="barChartData"
                  type="bar"
                  [options]="barChartOptions"
                  *ngIf="budgets.length > 0">
          </canvas>
          <div *ngIf="budgets.length === 0" class="no-chart-data">
            <p>No budget data available</p>
          </div>
        </div>
      </div>

      <!-- Small Chart 1: Doughnut Chart -->
      <div class="chart-card small secondary">
        <div class="chart-header">
          <h3>Budget Overview</h3>
          <p>Department breakdown</p>
        </div>
        <div class="chart-wrapper small">
          <canvas baseChart
                  [data]="doughnutChartData"
                  type="doughnut"
                  [options]="doughnutChartOptions"
                  *ngIf="budgets.length > 0">
          </canvas>
          <div *ngIf="budgets.length === 0" class="no-chart-data">
            <p>No data</p>
          </div>
        </div>
      </div>

      <!-- Small Chart 2: Pie Chart -->
      <div class="chart-card small tertiary">
        <div class="chart-header">
          <h3>Distribution</h3>
          <p>Budget allocation</p>
        </div>
        <div class="chart-wrapper small">
          <canvas baseChart
                  [data]="pieChartData"
                  type="pie"
                  [options]="pieChartOptions"
                  *ngIf="budgets.length > 0">
          </canvas>
          <div *ngIf="budgets.length === 0" class="no-chart-data">
            <p>No data</p>
          </div>
        </div>
      </div>

      <!-- Large Chart 2: Line Chart - Trend Analysis -->
      <div class="chart-card large quaternary">
        <div class="chart-header">
          <h3>Remaining Budget Trend Analysis</h3>
          <p>Monthly remaining budget pattern by department over time</p>
        </div>
        <div class="chart-wrapper large">
          <canvas baseChart
                  [data]="lineChartData"
                  type="line"
                  [options]="lineChartOptions">
          </canvas>
        </div>
      </div>

    </div>


  </div>
</div>
